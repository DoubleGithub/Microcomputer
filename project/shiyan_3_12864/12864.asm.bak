PORTA EQU 0200H ;8255的PA口地址 

PORTB EQU 0202H ;A1、A2用于端口选择 

PORTC EQU 0204H ;PC口⑸厦媸PB口 

PCONT EQU 0206H ;8255的控制口地址 

RESET EQU 11100010B ;LCD复位命令码 

DISP_ON EQU 10101111B ;LCD显示开命令码 

DISP_NOR EQU 10100110B ;LCD正常显示命令码 

DISP_ALL EQU 10100100B ;LCD所有点全部显示命令码 

LINE0 EQU 01000000B ;行号0开始⒌63 

PAGE0 EQU 10110000B ;页号0开始⒌7 

COLHIGH EQU 00010000B ;列号高四位 

COLLOW EQU 00000000B ;列号低四位⒐16列 

 

ADCA EQU 10100000B ;向左显示命令码 

DATA SEGMENT ;定义数据段 

;以下为0到9的字模半角数据⑸厦娴暮鹤质侨角的 

 

XI    DB 04H,0C4H,44H,44H,44H,0FCH,44H,44H,44H,0FCH,44H,44H,44H,0E6H,44H
      DB 00H,00H,0FFH,40H,50H,48H,47H,40H,40H,40H,47H,48H,48H,40H,0FFH,00H,00H  

BEI   DB 00H,20H,20H,20H,20H,0FFH,00H,00H,0FFH,20H,10H,08H,0CH,00H,00H,00H 

      DB 20H,60H,20H,10H,10H,7FH,00H,00H,3FH,40H,40H,40H,40H,40H,70H,00H 

 

SHI   DB 00H,0FCH,00H,00H,0FFH,00H,02H,0F2H,12H,12H,0FEH,12H,12H,0FBH,12H,00H 

      DB 00H,8FH,40H,30H,0FH,00H,00H,3FH,00H,00H,0FFH,10H,20H,1FH,00H,00H 

 

FAN   DB 04H,44H,94H,24H,6FH,04H,0E4H,24H,24H,24H,2FH,0F4H,24H,06H,04H,00H, 

         04H,04H,0FDH,04H,02H,00H,3FH,40H,40H,42H,44H,43H,40H,40H,70H,00H 

 

DA    DB 20H,20H,20H,20H,20H,20H,0A0H,7FH,0A0H,20H,20H,20H,20H,30H,20H,00H, 

         00H,40H,40H,20H,10H,0CH,03H,00H,01H,06H,08H,10H,20H,60H,20H,00H 

 

XUE   DB 40H,30H,11H,96H,90H,90H,91H,96H,90H,90H,98H,14H,13H,50H,30H,00H, 

         04H,04H,04H,04H,04H,44H,84H,7EH,06H,05H,04H,04H,04H,06H,04H,00H 

 

JI    DB 40H,40H,42H,0CCH,00H,40H,40H,40H,40H,0FFH,40H,40H,40H,60H,40H,00H, 

         00H,00H,00H,7FH,20H,10H,08H,00H,00H,0FFH,00H,00H,00H,00H,00H,00H 

 

SUAN  DB 08H,04H,03H,0FAH,0AEH,0AAH,0AAH,0ACH,0ABH,0AAH,0AEH,0FAH,02H,02H,00H,00H, 

         08H,08H,88H,4BH,3EH,0AH,0AH,0AH,0AH,0AH,0FEH,0BH,08H,0CH,08H,00H 

 

JIJ   DB 10H,10H,0D0H,0FFH,90H,10H,00H,0FCH,04H,04H,04H,0FEH,04H,00H,00H,00H, 

         04H,03H,00H,0FFH,80H,41H,20H,1FH,00H,00H,00H,3FH,40H,40H,70H,00H 

 

XUE1   DB 40H,30H,11H,96H,90H,90H,91H,96H,90H,90H,98H,14H,13H,50H,30H,00H, 

         04H,04H,04H,04H,04H,44H,84H,7EH,06H,05H,04H,04H,04H,06H,04H,00H 

 

YUAN  DB 00H,0FEH,22H,5AH,96H,0CH,24H,24H,25H,26H,24H,34H,0A4H,14H,0CH,00H, 

          00H,0FFH,04H,08H,87H,81H,41H,31H,0FH,01H,3FH,41H,41H,41H,70H,00H   30  

LI    DB 80H,84H,44H,44H,24H,14H,04H,0FFH,04H,14H,24H,24H,46H,0C4H,40H,00H, 

         00H,08H,08H,08H,09H,49H,89H,7DH,0DH,0BH,09H,08H,0CH,08H,00H,00H 

 

BIN   DB 10H,50H,92H,14H,0F0H,10H,20H,24H,24H,0A4H,24H,0FFH,20H,24H,28H,00H, 

         20H,10H,0DH,02H,05H,18H,40H,7FH,40H,3FH,22H,07H,38H,40H,0E0H,00H 

 

C0 DB 00H,0E0H,10H,08H,08H,10H,0E0H,00H 

DB 00H,0FH,10H,20H,20H,10H,0FH,00H 

C1 DB 00H,10H,10H,0F8H,00H,00H,00H,00H 

DB 00H,20H,20H,3FH,20H,20H,00H,00H 

C2 DB 00H,70H,08H,08H,08H,88H,70H,00H 

DB 00H,30H,28H,24H,22H,21H,30H,00H 

C3 DB 00H,30H,08H,88H,88H,48H,30H,00H 

DB 00H,18H,20H,20H,20H,11H,0EH,00H 

C4 DB 00H,00H,0C0H,20H,10H,0F8H,00H,00H 

DB 00H,07H,04H,24H,24H,3FH,24H,00H 

C5 DB 00H,0F8H,08H,88H,88H,08H,08H,00H 

DB 00H,19H,21H,20H,20H,11H,0EH,00H 

C6 DB 00H,0E0H,10H,88H,88H,18H,00H,00H 

DB 00H,0FH,11H,20H,20H,11H,0EH,00H 

C7 DB 00H,38H,08H,08H,0C8H,38H,08H,00H 

DB 00H,00H,00H,3FH,00H,00H,00H,00H 

C8 DB 00H,70H,88H,08H,08H,88H,70H,00H 

DB 00H,1CH,22H,21H,21H,22H,1CH,00H 

C9 DB 00H,0E0H,10H,08H,08H,10H,0E0H,00H 

DB 00H,00H,31H,22H,22H,11H,0FH,00H 

 

TEMP DB 32 DUP(0) ;临时字模数据区 

;X DB 0 ;显示位置的起始行号   31 ;Y DB 0 ;显示位置的起始列号 

DATA ENDS ;数据段定义结束 

 

STACK SEGMENT STACK ;准备定义堆栈段 

STP DW 100 DUP(?) ;预先定义的堆栈深度 

LEN EQU $-STP 

STACK ENDS ;堆栈段定义结束 

CODE SEGMENT 'code' ;定义代码段 

ASSUME CS:CODE,DS:DATA,SS:STACK 

START: 

MOV AX,DATA ;初始化数据段 

MOV DS,AX 

CALL INIT ;LCD初始化 

;准备显示福字SI<-字模位置,X->BL,Y->BH 

;MOV BL,0 

;MOV BH,0 

;LEA SI,FU 

;CALL DISPCHN 

;准备显示半角数字2,SI<-2的字模区首地址 

;列号->BL,行号->BH∫虬虢鞘字与全角汉字字模存储 

; 空间数不同」视貌煌的子程序来显示 

 

MOV BL,0 

MOV BH,0 

LEA SI,XI 

CALL DISPCHN 

MOV BL,1 

MOV BH,0 

LEA SI,BEI 

CALL DISPCHN   

MOV BL,2 

MOV BH,0 

LEA SI,SHI 

CALL DISPCHN 

MOV BL,3 

MOV BH,0 

LEA SI,FAN 

CALL DISPCHN 

MOV BL,4 

MOV BH,0 

LEA SI,DA 

CALL DISPCHN 

MOV BL,5 

MOV BH,0 

LEA SI,XUE 

CALL DISPCHN 

 

MOV BL,0 

MOV BH,1 

LEA SI,JI 

CALL DISPCHN 

MOV BL,1 

MOV BH,1 

LEA SI,SUAN 

CALL DISPCHN 

MOV BL,2 

MOV BH,1 

LEA SI,JIJ 

CALL DISPCHN 

MOV BL,3   

MOV BH,1 

LEA SI,XUE1 

CALL DISPCHN 

MOV BL,4 

MOV BH,1 

LEA SI,YUAN 

CALL DISPCHN 

 

MOV BL,0 

MOV BH,2 

LEA SI,LI 

CALL DISPCHN 

MOV BL,1 

MOV BH,2 

LEA SI,BIN 

CALL DISPCHN 

 

;原来的非半角数字显示 

;MOV BL,0 

;MOV BH,3 

;LEA SI,C2 

;CALL DISPCHA 

 

MOV BL,0 

MOV BH,3 

LEA SI,C2 

LEA DI,C0 

LEA BP,TEMP 

CALL FULLCHA 

MOV BL,1   

MOV BH,3 

LEA SI,C1 

LEA DI,C3 

LEA BP,TEMP 

CALL FULLCHA 

MOV BL,2 

MOV BH,3 

LEA SI,C7 

LEA DI,C1 

LEA BP,TEMP 

CALL FULLCHA 

MOV BL,3 

MOV BH,3 

LEA SI,C0 

LEA DI,C2 

LEA BP,TEMP 

CALL FULLCHA 

MOV BL,4 

MOV BH,3 

LEA SI,C0 

LEA DI,C1 

LEA BP,TEMP 

CALL FULLCHA 

MOV BL,5 

MOV BH,3 

LEA SI,C1 

LEA DI,C2 

LEA BP,TEMP 

CALL FULLCHA 

   ;显示完一个汉字和一个数字≡谠地循环等待 

JMP $ 

INIT PROC NEAR ;LCD与8255初始化子程序 

MOV AL,10000000B 

MOV DX,PCONT 

OUT DX,AL ;INIT 8255 

MOV AL,00000001B ;INIT LCD 

MOV DX,PORTB 

OUT DX,AL 

NOP 

MOV AL,RESET ;RESET 

MOV DX,PORTA 

OUT DX,AL 

NOP 

 

MOV AL,00000000B 

MOV DX,PORTB 

OUT DX,AL 

MOV AL,00000001B 

MOV DX,PORTB 

OUT DX,AL 

NOP 

MOV AL,DISP_ON ;DISP ON 

MOV DX,PORTA 

OUT DX,AL 

NOP 

MOV AL,00000000B 

 

MOV DX,PORTB 

OUT DX,AL   

MOV AL,00000001B 

MOV DX,PORTB 

OUT DX,AL 

NOP 

MOV AL,ADCA ;ADC 

INC AL 

MOV DX,PORTA 

OUT DX,AL 

NOP 

MOV AL,00000000B 

 

MOV DX,PORTB 

OUT DX,AL 

MOV AL,00000001B 

MOV DX,PORTB 

OUT DX,AL 

NOP 

MOV AL,DISP_ALL ;DISP ALL 

MOV DX,PORTA 

OUT DX,AL 

NOP 

MOV AL,00000000B 

MOV DX,PORTB 

 

OUT DX,AL 

MOV AL,00000001B 

MOV DX,PORTB 

OUT DX,AL 

NOP 

MOV AL,DISP_NOR ;DISP NOR   37 MOV DX,PORTA 

OUT DX,AL 

NOP 

MOV AL,00000000B 

MOV DX,PORTB 

OUT DX,AL 

 

RET 

INIT ENDP 

;以下为汉字显示子程序 

DISPCHN PROC NEAR 

PUSH CX 

PUSH DX 

PUSH AX 

PUSH DI 

PUSH SI 

MOV DI,BX 

MOV CL,4 

SHL BL,CL 

 

MOV AL,BL 

AND BL, 0FH 

MOV CL,4 

SHR AL,CL 

ADD AL,COLHIGH 

ADD BL,COLLOW 

MOV BH,AL 

MOV AL,00000001B 

MOV DX,PORTB 

OUT DX,AL   
 NOP 

MOV AL,BH ;COL HIGH 

 

MOV DX,PORTA 

OUT DX,AL 

NOP 

MOV AL,00000000B 

MOV DX,PORTB 

OUT DX,AL 

MOV AL,00000001B 

MOV DX,PORTB 

OUT DX,AL 

NOP 

MOV AL,BL ;COL LOW 

MOV DX,PORTA 

 

OUT DX,AL 

NOP 

MOV AL,00000000B 

MOV DX,PORTB 

OUT DX,AL 

MOV BX,DI 

MOV BL,BH 

SHL BL,1 

ADD BL,PAGE0 

MOV AL,00000001B 

MOV DX,PORTB 

OUT DX,AL 

 

NOP   

MOV AL,BL ;ROW 1 

MOV DX,PORTA 

OUT DX,AL 

NOP 

MOV AL,00000000B 

MOV DX,PORTB 

OUT DX,AL 

MOV CX,16 

HIGHE: 

MOV AL,00000011B 

MOV DX,PORTB 

 

OUT DX,AL 

DATA1: 

MOV AL,[SI] 

MOV DX,PORTA 

OUT DX,AL 

NOP 

NOP 

INC SI 

DATAE: 

MOV AL,00000010B 

MOV DX,PORTB 

OUT DX,AL 

 

NOP 

NOP 

LOOP HIGHE 

MOV BX,DI 

MOV BL,BH   
SHL BL,1 

ADD BL,PAGE0 

INC BL 

MOV AL,00000001B 

MOV DX,PORTB 

OUT DX,AL 

NOP 

 

MOV AL,BL ;ROW 2 

MOV DX,PORTA 

OUT DX,AL 

NOP 

MOV AL,00000000B 

MOV DX,PORTB 

OUT DX,AL 

MOV BX,DI 

MOV CL,4 

SHL BL,CL 

MOV AL,BL 

AND BL,0FH 

 

MOV CL,4 

SHR AL,CL 

ADD AL,COLHIGH 

ADD BL,COLLOW 

MOV BH,AL 

MOV AL,00000001B 

MOV DX,PORTB 

OUT DX,AL 

NOP   

MOV AL,BH ;COL HIGH 

MOV DX,PORTA 

OUT DX,AL 

 

NOP 

MOV AL,00000000B 

MOV DX,PORTB 

OUT DX,AL 

MOV AL,00000001B 

MOV DX,PORTB 

OUT DX,AL 

NOP 

MOV AL,BL ;COL LOW 

MOV DX,PORTA 

OUT DX,AL 

NOP 

 

MOV AL,00000000B 

MOV DX,PORTB 

OUT DX,AL 

POP SI 

ADD SI,16 

MOV CX,16 

HIGHE2: 

MOV AL,00000011B 

MOV DX,PORTB 

OUT DX,AL 

DATA2: 

MOV AL,[SI] 

MOV DX,PORTA 

OUT DX,AL 

NOP 

NOP 

INC SI 

DATAE2: 

MOV AL,00000010B 

MOV DX,PORTB 

OUT DX,AL 

NOP 

NOP 

LOOP HIGHE2 

 

POP DI 

POP AX 

POP DX 

POP CX 

RET 

DISPCHN ENDP 

;以下为显示半角字母、数字的子程序 

DISPCHA PROC NEAR 

PUSH CX 

PUSH DX 

PUSH AX 

 

PUSH DI 

PUSH SI 

MOV DI,BX 

MOV CL,4 ;4 

SHL BL,CL    

MOV AL,BL 

AND BL,0FH ;0F 

MOV CL,4 ;4 

SHR AL,CL 

ADD AL,COLHIGH 

ADD BL,COLLOW 

MOV BH,AL 

 

MOV AL,00000001B 

MOV DX,PORTB 

OUT DX,AL 

NOP 

MOV AL,BH ;COL HIGH 

MOV DX,PORTA 

OUT DX,AL 

NOP 

MOV AL,00000000B 

MOV DX,PORTB 

OUT DX,AL 

MOV AL,00000001B 

 

MOV DX,PORTB 

OUT DX,AL 

NOP 

MOV AL,BL ;COL LOW 

MOV DX,PORTA 

OUT DX,AL 

NOP 

MOV AL,00000000B 

MOV DX,PORTB    

OUT DX,AL 

MOV BX,DI 

MOV BL,BH ;Y 

 

SHL BL,1 

ADD BL,PAGE0 

MOV AL,00000001B 

MOV DX,PORTB 

OUT DX,AL 

NOP 

MOV AL,BL ;ROW 1 

MOV DX,PORTA 

OUT DX,AL 

NOP 

MOV AL,00000000B 

MOV DX,PORTB 

 

OUT DX,AL 

MOV CX,8 

HIGHEC: 

MOV AL,00000011B 

MOV DX,PORTB 

OUT DX,AL 

DATA1C: 

MOV AL,[SI] 

MOV DX,PORTA 

OUT DX,AL 

NOP 

NOP 

INC SI 

DATAEC: 

MOV AL,00000010B 

MOV DX,PORTB 

OUT DX,AL 

NOP 

NOP 

LOOP HIGHEC 

MOV BX,DI 

MOV BL,BH 

SHL BL,1 

ADD BL,PAGE0 

 

INC BL 

MOV AL,00000001B 

MOV DX,PORTB 

OUT DX,AL 

NOP 

MOV AL,BL ;ROW 2 

MOV DX,PORTA 

OUT DX,AL 

NOP 

MOV AL,00000000B 

MOV DX,PORTB 

OUT DX,AL 

 

MOV BX,DI 

MOV CL,4 ;4 

SHL BL,CL 

MOV AL,BL    

AND BL, 0FH ;0F 

MOV CL,4 ;4 

SHR AL,CL 

ADD AL,COLHIGH 

ADD BL,COLLOW 

MOV BH,AL 

MOV AL,00000001B 

MOV DX,PORTB 

 

OUT DX,AL 

NOP 

MOV AL,BH ;COL HIGH 

MOV DX,PORTA 

OUT DX,AL 

NOP 

MOV AL,00000000B 

MOV DX,PORTB 

OUT DX,AL 

MOV AL,00000001B 

MOV DX,PORTB 

OUT DX,AL 

 

NOP 

MOV AL,BL ;COL LOW 

MOV DX,PORTA 

OUT DX,AL 

NOP 

MOV AL,00000000B 

MOV DX,PORTB 

OUT DX,AL  

POP SI 

ADD SI,8 

MOV CX,8 

HIGHE2C: 

 

MOV AL,00000011B 

MOV DX,PORTB 

OUT DX,AL 

DATA2C: 

MOV AL,[SI] 

MOV DX,PORTA 

OUT DX,AL 

NOP 

NOP 

INC SI 

DATAE2C: 

MOV AL,00000010B 

 

MOV DX,PORTB 

OUT DX,AL 

NOP 

NOP 

LOOP HIGHE2C 

POP DI 

POP AX 

POP DX 

POP CX 

RET 

DISPCHA ENDP 

 ;合并不同半角字符字模的子程序 

FULLCHA PROC NEAR 

PUSH SI 

PUSH DI 

PUSH CX 

PUSH BX 

PUSH AX 

MOV CX,4 

MOV BX,BP 

TLOP1: 

MOV AX,[SI] 

MOV [BX],AX 

INC SI 

 

INC SI 

INC BX 

INC BX 

LOOP TLOP1 

MOV CX,4 

TLOP2: 

MOV AX,[DI] 

MOV [BX],AX 

INC DI 

INC DI 

INC BX 

INC BX 

 

LOOP TLOP2 

MOV CX,4 

TLOP3:   

MOV AX,[SI] 

MOV [BX],AX 

INC SI 

INC SI 

INC BX 

INC BX 

LOOP TLOP3 

MOV CX,4 

TLOP4: 

 

MOV AX,[DI] 

MOV [BX],AX 

INC DI 

INC DI 

INC BX 

INC BX 

LOOP TLOP4 

POP AX 

POP BX 

POP CX 

POP DI 

POP SI 

MOV SI,BP 

CALL DISPCHN 

RET 

FULLCHA ENDP 

CODE ENDS 

END START 